@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewData["Title"] = "Add SharePoint Integration to Power Pages Forms |";
}
@{
    Layout = "~/Views/Shared/_PowerPagesLayout.cshtml";
}
@section MetaTags {
    <meta name="title" content="Add SharePoint Integration to Power Pages Forms">
    <meta name="description" content="Integrate SharePoint with Power Pages forms, enable document management, and add a document location subgrid for seamless file uploads." />
    <meta name="keywords" content="Power Pages blogs, Power Pages tutorials, Power Platform development, Power Pages tips, Power Pages best practices, Power Pages SharePoint integration, Power Pages file management, Power Pages customization, Power Platform websites, building dynamic websites with Power Pages, Microsoft Power Pages resources" />
    <meta name="author" content="Voxtus" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta property="og:title" content="Add SharePoint Integration to Power Pages Forms" />
}

<div class="container  text-justify mt-4  bg-light service-details align-content-center" style="border:2px solid black">
    <div class="mt-2 mx-3">
        <h1 class="mt-4 mx-3 text-center">
            How to Add a Document Location Subgrid in a Form with SharePoint Integration.
        </h1><hr />
    </div>
    <div class="mt-3 mx-3 bg-white pt-1 pb-2 p-3">
        <p class="mt-3 mx-3">Integrating SharePoint with Power Pages allows users to upload, manage, and access files directly from forms, creating a seamless experience. This blog provides a comprehensive guide to setting up SharePoint integration, configuring document management for tables, and adding a document location subgrid to your forms.</p>
        <h4 class="mt-4 mx-3">Step 1: Set Up Your SharePoint Site</h4>
        <p class="mt-3 mx-3">The first step in enabling SharePoint integration is to create a dedicated SharePoint site:</p>
        <ol class="mx-3 mt-3">
            <li><b>Log in to SharePoint:</b> Access your SharePoint account using your credentials.</li>
            <li><b>Create a New Site:</b>
                <ul class="mx-3 mt-3">
                    <li>Navigate to the <span class="fw-semibold">"Create Site"</span> option.</li>
                    <li>Choose between a <span class="fw-semibold">Team Site</span> or <span class="fw-semibold">Communication Site</span> based on your needs.</li>
                    <li>Name your site appropriately (e.g., "Expense Management Files").</li>
                </ul>
                </li>
            <li><b>Note the URL:</b> After the site is created, make a note of the SharePoint URL, as you will need it for configuration in Power Pages.</li>
        </ol>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/SharePoint Site.webp" alt="SharePoint Site" title="SharePoint Site" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <p class="mt-3 mx-3">Creating a specific SharePoint site ensures that all uploaded documents are stored in a centralized and secure location, simplifying management and retrieval.</p>
        <h4 class="mt-4 mx-3">Step 2: Enable SharePoint Integration in Power Pages</h4>
        <p class="mt-3 mx-3">To integrate your SharePoint site with Power Pages:</p>
        <h6 class="mt-4 mx-3">1. Access Power Platform Admin Center:</h6>
        <ul class="mx-3 mt-3">
            <li>Go to <a href="https://admin.powerplatform.microsoft.com/" target="_blank" class="text-decoration-none">Power Platform Admin Center</a>.</li>
        </ul>
        <h6 class="mt-4 mx-3">2. Select the Environment:</h6>
        <ul class="mx-3 mt-3">
            <li>On the left-hand menu, choose <span class="fw-semibold">Environments</span> and select the environment where your Power Pages site is hosted.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Select the Environment.webp" alt="Select the Environment" title="Select the Environment" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <h6 class="mt-4 mx-3">3. Navigate to Resources:</h6>
        <ul class="mx-3 mt-3">
            <li>Under <span class="fw-semibold">Resources</span>, select <span class="fw-semibold">Power Pages sites</span>.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Power Pages sites.webp" alt="Power Pages sites" title="Power Pages sites" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <h6 class="mt-4 mx-3">4. Manage Your Site:</h6>       
        <ul class="mx-3 mt-3">
            <li>Find your Power Pages site and click <span class="fw-semibold">Manage</span>.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Click Manage.webp" alt="Click Manage" title="Click Manage" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <ul class="mx-3 mt-3">
            <li>Scroll down to the <span class="fw-semibold">Services</span> section on the right-hand side.</li>
            <li>Toggle <span class="fw-semibold">Enable SharePoint Integration</span> to <span class="fw-semibold">"Yes."</span></li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Enable SharePoint Integration.webp" alt="Enable SharePoint Integration" title="Enable SharePoint Integration" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <p class="mt-3 mx-3">This step ensures that your Power Pages site is configured to use SharePoint for document storage and management.</p>
        <h4 class="mt-4 mx-3">Step 3: Configure Document Management for Your Table</h4>
        <p class="mt-3 mx-3">To enable document management for your table and integrate it with SharePoint, follow these detailed steps:</p>
        <h6 class="mt-4 mx-3">1. Access Advanced Settings:</h6>
        <ul class="mx-3 mt-3">
            <li>Navigate to <span class="fw-semibold">Settings > Advanced Settings</span> in your Power Apps environment.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Advanced Settings.webp" alt="Advanced Settings" title="Advanced Settings" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <h6 class="mt-4 mx-3">2. Enable Server-Based SharePoint Integration:</h6>
        <ul class="mx-3 mt-3">
            <li>Go to <span class="fw-semibold">Document Management</span> and select <span class="fw-semibold">Enable Server-Based SharePoint Integration</span>.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Document Management.webp" alt="Document Management" title="Document Management" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Enable Server-Based SharePoint Integration.webp" alt="Enable Server-Based SharePoint Integration" title="Enable Server-Based SharePoint Integration" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <ul class="mx-3 mt-3">
            <li>Click <span class="fw-semibold">Next</span> to proceed.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Next.webp" alt="Next" title="Next" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <ul class="mx-3 mt-3">
            <li>Choose <span class="fw-semibold">Online</span> to indicate that your SharePoint sites are hosted online.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Online ANd Next.webp" alt="Online ANd Next" title="Online ANd Next" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <ul class="mx-3 mt-3">
            <li>Click <span class="fw-semibold">Next</span> again.</li>
        </ul>
        <h6 class="mt-4 mx-3">3. Add Your SharePoint Site URL:</h6>
        <ul class="mx-3 mt-3">
            <li>Paste the URL of the SharePoint site you created earlier.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/SharePoint Site URL.webp" alt="SharePoint Site URL" title="SharePoint Site URL" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <ul class="mx-3 mt-3">
            <li>Click <span class="fw-semibold">Next</span> to validate the URL. If the URL is valid, click <span class="fw-semibold">Finish</span> to complete this step.</li>
        </ul>
        <h6 class="mt-4 mx-3">4. Configure Document Management Settings:</h6>
        <ul class="mx-3 mt-3">
            <li>After enabling SharePoint integration, select <span class="fw-semibold">Document Management Settings</span>.</li>
         </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Document Management Settings.webp" alt="Document Management Settings" title="Document Management Settings" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <ul class="mx-3 mt-3">
            <li>Add the SharePoint site URL again if required.</li>
            <li>Choose the table(s) you want to enable for document management (e.g., "Expense").</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Finish.webp" alt="Finish" title="Finish" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <ul class="mx-3 mt-3">
            <li>Complete the configuration by saving your settings.</li>
        </ul>
        <p class="mt-3 mx-3">Enabling server-based SharePoint integration ensures that your Power Pages forms can securely interact with SharePoint for document storage and management.</p>
        <h4 class="mt-4 mx-3">Step 4: Add a Document Location Subgrid to Your Form</h4>
        <p class="mt-3 mx-3">The document location subgrid provides users with a clear interface to manage uploaded files:</p>
        <h6 class="mt-4 mx-3">1. Edit Your Form:</h6>
        <ul class="mx-3 mt-3">
            <li>Go to <span class="fw-semibold">Advanced Settings > Solutions</span> and select your solution.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Solutions.webp" alt="Solutions" title="Solutions" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <ul class="mx-3 mt-3">
            <li>Locate your table (e.g., "Expense") and choose the form you want to edit.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Choose the form you want to edit.webp" alt="Choose the form you want to edit" title="Choose the form you want to edit" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <h6 class="mt-4 mx-3">2. Insert a Section for Documents:</h6>
        <ul class="mx-3 mt-3">
            <li>In the form editor, click <span class="fw-semibold">Insert > Section</span> to add a new section where the subgrid will be placed.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Insert a Section for Documents.webp" alt="Insert a Section for Documents" title="Insert a Section for Documents" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <h6 class="mt-4 mx-3">3. Add a Subgrid:</h6>
        <ul class="mx-3 mt-3">
            <li>Inside the new section, insert a <span class="fw-semibold">Subgrid</span>.</li>
            <li>Configure the subgrid to display <span class="fw-semibold">Active Document Locations</span> as the default view.</li>
            <li>Assign it a descriptive name, such as <span class="fw-semibold">"Document Uploads."</span></li>
        </ul>
        <h6 class="mt-4 mx-3">4. Customize the Label:</h6>
        <ul class="mx-3 mt-3">
            <li>Add a user-friendly label to the subgrid for clarity (e.g., "Upload Supporting Documents").</li>
        </ul>
        <h6 class="mt-4 mx-3">5. Save and Publish:</h6>
        <ul class="mx-3 mt-3">
            <li>Save your changes, publish the form, and return to your solution.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Save and Publish.webp" alt="Save and Publish" title="Save and Publish" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <h6 class="mt-4 mx-3">6. Publish All Customizations:</h6>
        <ul class="mx-3 mt-3">
            <li>Ensure all customizations are published to make them active.</li>
        </ul>
        <p class="mt-3 mx-3">The subgrid enables users to view, upload, and manage documents linked to each record directly from the form.</p>
        <h4 class="mt-4 mx-3">Step 5: Set Up Table Permissions</h4>
        <p class="mt-3 mx-3">To ensure proper access control for uploaded files, you need to configure table permissions:</p>
        <h6 class="mt-4 mx-3">1. Access Portal Management:</h6>
        <ul class="mx-3 mt-3">
            <li><span class="fw-semibold">Open Portal Management</span> and navigate to <span class="fw-semibold">Security > Table Permissions</span>.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/Table Permissions.webp" alt="Table Permissions" title="Table Permissions" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <h6 class="mt-4 mx-3">2. Create a Permission for File Uploads:</h6>
        <ul class="mx-3 mt-3">
            <li>Add a new permission named <span class="fw-semibold">File Upload</span>.</li>
            <li>Select the relevant table (e.g., "Expense").</li>
            <li>Choose your Power Pages site under <span class="fw-semibold">Website</span>.</li>
            <li>Set <span class="fw-semibold">Access Type</span> to <span class="fw-semibold">Global</span>.</li>
            <li>Add the required privileges (e.g., Create, Read, Write).</li>
            <li>Assign appropriate <span class="fw-semibold">Web Roles</span> to the permission.</li>
            <li>Save the permission.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/File Uploads.webp" alt="File Uploads" title="File Uploads" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <h6 class="mt-4 mx-3">3. Create a Permission for SharePoint Document Locations:</h6>
        <ul class="mx-3 mt-3">
            <li>Add another permission named <span class="fw-semibold">File Upload SharePoint Document</span>.</li>
            <li>Select the <span class="fw-semibold">Document Location (SharePointDocumentLocation)</span> table.</li>
            <li>Link it to the parent table using the <span class="fw-semibold">Parent Relationship</span> field.</li>
            <li>Set <span class="fw-semibold">Access Type</span> to <span class="fw-semibold">Parent</span>.</li>
            <li>Add privileges and save the permission.</li>
        </ul>
        <img src="~/images/blog/powerpages/avfsexpensemanagement/File Upload SharePoint Document.webp" alt="File Upload SharePoint Document" title="File Upload SharePoint Document" loading="lazy" class="img-fluid img-thumbnail rounded mx-auto d-block h-50" />
        <p class="mt-3 mx-3">These permissions ensure that users can upload and view files securely based on their roles.</p>
        <hr />
        <h4 class="mt-4 mx-3">Benefits of This Integration</h4>
        <p class="mt-3 mx-3">Integrating SharePoint with Power Pages provides numerous advantages:</p>
        <ul class="mx-3 mt-3">
            <li><b>Centralized Document Storage:</b> All uploaded files are stored in a single, secure SharePoint site.</li>
            <li><b>Improved Collaboration:</b> Files can be accessed and shared across teams directly from Power Pages forms.</li>
            <li><b>Enhanced User Experience:</b> The document location subgrid offers a user-friendly interface for managing files.</li>
            <li><b>Role-Based Access Control:</b> Permissions ensure that only authorized users can upload or view documents.</li>
        </ul>
        <hr />
        <h4 class="mt-4 mx-3">Conclusion</h4>
        <p class="mt-3 mx-3">By following these steps, you can effectively integrate SharePoint with Power Pages, enabling seamless file management within your forms. This setup enhances productivity, ensures data security, and streamlines the user experience.</p>
        <p class="mt-3 mx-3">Ready to take your Power Pages forms to the next level? Start integrating SharePoint today!</p>

    </div>
    <hr />
    <div class="row mb-2">
        <h6 class="text-center text-primary">
            If you have any doubts or questions related to this blog, you can Contact us by Email: <a href="mailto:info@voxtus.com" target="_blank" class="text-decoration-none">info@voxtus.com</a>
        </h6>
    </div>
    <div class="row">
        <div class="col-8"></div>
        <div class="col-4"><p><b>Shivani Gusain<br />Power Pages Consultant</b></p></div>
    </div>
</div>